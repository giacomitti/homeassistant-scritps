#
# Script to create JE05 sensors and buttons using MQTT Discovery
#
# include in scripts.yaml
# change je05_name, je05_devid, je05_pub and je05_sub
#
create_je05_mqtt_discovery:
  alias: "Create JE05 MQTT Discovery"
  variables:
    je05_name: "0-JE05"
    je05_devid: "2457355"
    je05_pub: "JE05/pub"
    je05_sub: "JE05/sub"
  sequence:
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/VARMS/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} VARMS",
            "object_id": "je05_{{je05_devid}}_VARMS",
            "unique_id": "je05_{{je05_devid}}_VARMS",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.VARMS}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "voltage",
            "unit_of_measurement": "V",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/IARMS/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} IARMS",
            "object_id": "je05_{{je05_devid}}_IARMS",
            "unique_id": "je05_{{je05_devid}}_IARMS",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{((value_json.DATA.IARMS | float / 10 | float) | round(1))}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "current",
            "unit_of_measurement": "A",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/PA/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} PA",
            "object_id": "je05_{{je05_devid}}_PA",
            "unique_id": "je05_{{je05_devid}}_PA",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.PA}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "power",
            "unit_of_measurement": "W",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/QA/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} QA",
            "object_id": "je05_{{je05_devid}}_QA",
            "unique_id": "je05_{{je05_devid}}_QA",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.QA}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "reactive_power",
            "unit_of_measurement": "var",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/SA/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} SA",
            "object_id": "je05_{{je05_devid}}_SA",
            "unique_id": "je05_{{je05_devid}}_SA",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.SA}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "apparent_power",
            "unit_of_measurement": "VA",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/FPA/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} FPA",
            "object_id": "je05_{{je05_devid}}_FPA",
            "unique_id": "je05_{{je05_devid}}_FPA",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{(((value_json.DATA.FPA | float / 1000 | float) | round(3)))}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "power_factor",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/KVARHA/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} KVARHA",
            "object_id": "je05_{{je05_devid}}_KVARHA",
            "unique_id": "je05_{{je05_devid}}_KVARHA",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{(value_json.DATA.KVARHA / 1000 | float)}}{% else %}{{''}}{% endif %}"}}",
            "unit_of_measurement": "kVAh",
            "icon": "mdi:lightning-bolt-outline",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/KWHA/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} KWHA",
            "object_id": "je05_{{je05_devid}}_KWHA",
            "unique_id": "je05_{{je05_devid}}_KWHA",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{(value_json.DATA.KWHA / 1000 | float)}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "energy",
            "unit_of_measurement": "kWh",
            "state_class": "total",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/VBRMS/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} VBRMS",
            "object_id": "je05_{{je05_devid}}_VBRMS",
            "unique_id": "je05_{{je05_devid}}_VBRMS",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.VBRMS}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "voltage",
            "unit_of_measurement": "V",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/IBRMS/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} IBRMS",
            "object_id": "je05_{{je05_devid}}_IBRMS",
            "unique_id": "je05_{{je05_devid}}_IBRMS",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{((value_json.DATA.IBRMS | float / 10 | float) | round(1))}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "current",
            "unit_of_measurement": "A",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/PB/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} PB",
            "object_id": "je05_{{je05_devid}}_PB",
            "unique_id": "je05_{{je05_devid}}_PB",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.PB}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "power",
            "unit_of_measurement": "W",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/QB/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} QB",
            "object_id": "je05_{{je05_devid}}_QB",
            "unique_id": "je05_{{je05_devid}}_QB",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.QB}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "reactive_power",
            "unit_of_measurement": "var",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/SB/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} SB",
            "object_id": "je05_{{je05_devid}}_SB",
            "unique_id": "je05_{{je05_devid}}_SB",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.SB}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "apparent_power",
            "unit_of_measurement": "VA",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/FPB/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} FPB",
            "object_id": "je05_{{je05_devid}}_FPB",
            "unique_id": "je05_{{je05_devid}}_FPB",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{(((value_json.DATA.FPB | float / 1000 | float) | round(3)))}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "power_factor",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/KVARHB/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} KVARHB",
            "object_id": "je05_{{je05_devid}}_KVARHB",
            "unique_id": "je05_{{je05_devid}}_KVARHB",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{(value_json.DATA.KVARHB / 1000 | float)}}{% else %}{{''}}{% endif %}"}}",
            "unit_of_measurement": "kVAh",
            "icon": "mdi:lightning-bolt-outline",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/KWHB/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} KWHB",
            "object_id": "je05_{{je05_devid}}_KWHB",
            "unique_id": "je05_{{je05_devid}}_KWHB",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{(value_json.DATA.KWHB / 1000 | float)}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "energy",
            "unit_of_measurement": "kWh",
            "state_class": "total",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/VCRMS/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} VCRMS",
            "object_id": "je05_{{je05_devid}}_VCRMS",
            "unique_id": "je05_{{je05_devid}}_VCRMS",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.VCRMS}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "voltage",
            "unit_of_measurement": "V",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/ICRMS/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} ICRMS",
            "object_id": "je05_{{je05_devid}}_ICRMS",
            "unique_id": "je05_{{je05_devid}}_ICRMS",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{((value_json.DATA.ICRMS | float / 10 | float) | round(1))}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "current",
            "unit_of_measurement": "A",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/PC/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} PC",
            "object_id": "je05_{{je05_devid}}_PC",
            "unique_id": "je05_{{je05_devid}}_PC",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.PC}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "power",
            "unit_of_measurement": "W",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/QC/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} QC",
            "object_id": "je05_{{je05_devid}}_QC",
            "unique_id": "je05_{{je05_devid}}_QC",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.QC}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "reactive_power",
            "unit_of_measurement": "var",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/SC/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} SC",
            "object_id": "je05_{{je05_devid}}_SC",
            "unique_id": "je05_{{je05_devid}}_SC",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.SC}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "apparent_power",
            "unit_of_measurement": "VA",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/FPC/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} FPC",
            "object_id": "je05_{{je05_devid}}_FPC",
            "unique_id": "je05_{{je05_devid}}_FPC",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{(((value_json.DATA.FPC | float / 1000 | float) | round(3)))}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "power_factor",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/KVARHC/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} KVARHC",
            "object_id": "je05_{{je05_devid}}_KVARHC",
            "unique_id": "je05_{{je05_devid}}_KVARHC",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{(value_json.DATA.KVARHC / 1000 | float)}}{% else %}{{''}}{% endif %}"}}",
            "unit_of_measurement": "kVAh",
            "icon": "mdi:lightning-bolt-outline",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/KWHC/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} KWHC",
            "object_id": "je05_{{je05_devid}}_KWHC",
            "unique_id": "je05_{{je05_devid}}_KWHC",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{(value_json.DATA.KWHC / 1000 | float)}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "energy",
            "unit_of_measurement": "kWh",
            "state_class": "total",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/PT/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} PT",
            "object_id": "je05_{{je05_devid}}_PT",
            "unique_id": "je05_{{je05_devid}}_PT",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.PT}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "power",
            "unit_of_measurement": "W",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/QT/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} QT",
            "object_id": "je05_{{je05_devid}}_QT",
            "unique_id": "je05_{{je05_devid}}_QT",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.QT}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "reactive_power",
            "unit_of_measurement": "var",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/ST/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} ST",
            "object_id": "je05_{{je05_devid}}_ST",
            "unique_id": "je05_{{je05_devid}}_ST",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.ST}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "apparent_power",
            "unit_of_measurement": "VA",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/FPT/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} FPT",
            "object_id": "je05_{{je05_devid}}_FPT",
            "unique_id": "je05_{{je05_devid}}_FPT",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{((value_json.DATA.FPT | float / 1000 | float) | round(3))}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "power_factor",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/KVARHT/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} KVARHT",
            "object_id": "je05_{{je05_devid}}_KVARHT",
            "unique_id": "je05_{{je05_devid}}_KVARHT",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{(value_json.DATA.KVARHT / 1000 | float)}}{% else %}{{''}}{% endif %}"}}",
            "unit_of_measurement": "kVAh",
            "icon": "mdi:lightning-bolt-outline",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/KWHT/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} KWHT",
            "object_id": "je05_{{je05_devid}}_KWHT",
            "unique_id": "je05_{{je05_devid}}_KWHT",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{(value_json.DATA.KWHT / 1000 | float)}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "energy",
            "unit_of_measurement": "kWh",
            "state_class": "total",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/VABRMS/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} VABRMS",
            "object_id": "je05_{{je05_devid}}_VABRMS",
            "unique_id": "je05_{{je05_devid}}_VABRMS",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.VABRMS}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "voltage",
            "unit_of_measurement": "V",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/VBCRMS/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} VBCRMS",
            "object_id": "je05_{{je05_devid}}_VBCRMS",
            "unique_id": "je05_{{je05_devid}}_VBCRMS",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.VBCRMS}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "voltage",
            "unit_of_measurement": "V",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/VCARMS/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} VCARMS",
            "object_id": "je05_{{je05_devid}}_VCARMS",
            "unique_id": "je05_{{je05_devid}}_VCARMS",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.VCARMS}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "voltage",
            "unit_of_measurement": "V",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/VABCTRMS/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} VABCTRMS",
            "object_id": "je05_{{je05_devid}}_VABCTRMS",
            "unique_id": "je05_{{je05_devid}}_VABCTRMS",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.VABCTRMS}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "voltage",
            "unit_of_measurement": "V",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/FREQ/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} FREQ",
            "object_id": "je05_{{je05_devid}}_FREQ",
            "unique_id": "je05_{{je05_devid}}_FREQ",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{(value_json.DATA.FREQ / 100 | float)}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "frequency",
            "unit_of_measurement": "Hz",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/TEMP/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} TEMP",
            "object_id": "je05_{{je05_devid}}_TEMP",
            "unique_id": "je05_{{je05_devid}}_TEMP", 
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{(value_json.DATA.TEMP / 10 | float)}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "temperature",
            "unit_of_measurement": "°C",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/SERRS/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} SERRS",
            "object_id": "je05_{{je05_devid}}_SERRS",
            "unique_id": "je05_{{je05_devid}}_SERRS",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.SERRS}}{% else %}{{''}}{% endif %}"}}", 
            "icon":"mdi:alert-circle-outline",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/WRSSI/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} WRSSI",
            "object_id": "je05_{{je05_devid}}_WRSSI",
            "unique_id": "je05_{{je05_devid}}_WRSSI", 
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.WRSSI}}{% else %}{{''}}{% endif %}"}}",      
            "device_class": "signal_strength",
            "unit_of_measurement": "dBm",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/UPTIME/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} UPTIME",
            "object_id": "je05_{{je05_devid}}_UPTIME",
            "unique_id": "je05_{{je05_devid}}_UPTIME",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'DATA' in value_json %}{{value_json.DATA.UPTIME}}{% else %}{{''}}{% endif %}"}}",
            "device_class": "duration",
            "unit_of_measurement": "s",
            "icon":"mdi:clock-time-eight-outline",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/DEVID/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} DEVID",
            "object_id": "je05_{{je05_devid}}_DEVID",
            "unique_id": "je05_{{je05_devid}}_DEVID", 
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'INFO' in value_json %}{{value_json.INFO.DEVID}}{% else %}{{''}}{% endif %}"}}",
            "icon":"mdi:identifier",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/DEVNAME/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} DEVNAME",
            "object_id": "je05_{{je05_devid}}_DEVNAME",
            "unique_id": "je05_{{je05_devid}}_DEVNAME",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'INFO' in value_json %}{{value_json.INFO.DEVNAME}}{% else %}{{''}}{% endif %}"}}",
            "icon":"mdi:form-textbox",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/DEVIP/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} DEVIP",
            "object_id": "je05_{{je05_devid}}_DEVIP",
            "unique_id": "je05_{{je05_devid}}_DEVIP",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'INFO' in value_json %}{{value_json.INFO.DEVIP}}{% else %}{{''}}{% endif %}"}}",
            "icon":"mdi:ip-outline",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/DEVMAC/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} DEVMAC",
            "object_id": "je05_{{je05_devid}}_DEVMAC",
            "unique_id": "je05_{{je05_devid}}_DEVMAC",  
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'INFO' in value_json %}{{value_json.INFO.DEVMAC}}{% else %}{{''}}{% endif %}"}}",
            "icon":"mdi:hexadecimal",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/DEVTYPE/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} DEVTYPE",
            "object_id": "je05_{{je05_devid}}_DEVTYPE",
            "unique_id": "je05_{{je05_devid}}_DEVTYPE", 
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'INFO' in value_json %}{{value_json.INFO.DEVTYPE}}{% else %}{{''}}{% endif %}"}}",
            "icon":"mdi:devices",        
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/DEVSUBTYPE/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} DEVSUBTYPE",
            "object_id": "je05_{{je05_devid}}_DEVSUBTYPE",
            "unique_id": "je05_{{je05_devid}}_DEVSUBTYPE",
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'INFO' in value_json %}{{value_json.INFO.DEVSUBTYPE}}{% else %}{{''}}{% endif %}"}}",
            "icon":"mdi:raspberry-pi",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/sensor/{{je05_devid}}/VERSION/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} VERSION",
            "object_id": "je05_{{je05_devid}}_VERSION",
            "unique_id": "je05_{{je05_devid}}_VERSION", 
            "state_topic": "{{je05_pub}}",
            "value_template": "{{"{% if 'INFO' in value_json %}{{value_json.INFO.VERSION}}{% else %}{{''}}{% endif %}"}}",
            "icon":"mdi:alpha-v",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/button/{{je05_devid}}/get_info/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} GETINFO",
            "object_id": "je05_{{je05_devid}}_get_info",
            "unique_id": "je05_{{je05_devid}}_get_info",
            "command_topic": "{{je05_sub}}",
            "payload_press": "{\"GET\":\"INFO\"}",
            "icon":"mdi:alpha-i-circle-outline",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/button/{{je05_devid}}/rst_kwh/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} RSTKWH",
            "object_id": "je05_{{je05_devid}}_rst_kwh",
            "unique_id": "je05_{{je05_devid}}_rst_kwh",
            "command_topic": "{{je05_sub}}",
            "payload_press": "{\"RST\":\"KWH\"}",
            "icon":"mdi:restart",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
    - service: mqtt.publish
      data:
        topic: homeassistant/button/{{je05_devid}}/rst_kvarh/config
        retain: true
        payload: >
          {
            "name": "{{je05_name}} RSTKVARH",
            "object_id": "je05_{{je05_devid}}_rst_kvarh",
            "unique_id": "je05_{{je05_devid}}_rst_kvarh",
            "command_topic": "{{je05_sub}}",
            "payload_press": "{\"RST\":\"KVARH\"}",
            "icon":"mdi:restart",
            "device": {
              "identifiers": [
                "JE05_{{je05_devid}}"
              ],
              "model": "JE05",
              "name": "JE05",
              "manufacturer": "BINTECHNOLOGY"
            }
          }
